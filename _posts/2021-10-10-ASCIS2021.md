---
layout: post
title: ASCIS 2021
date: 2021-10-10 00:00:00 +0300
description: WU Crypto # Add post description (optional)
img: ASCIS2021-panel.png # Add image post (optional)
tags: [Crypto, CTF, Misc] # add tag
---

**HÃ© lÃ´ cÃ¡c anh em Ä‘Ã£ Ä‘áº¿n vá»›i vÃ²ng sÆ¡ kháº£o SVATTT 2021, nhÃ¢n dá»‹p team mÃ¬nh clear thÃ¬ mÃ¬nh xin chia sáº½ wu nha** ğŸ¥°ğŸ¥°ğŸ˜˜

![image.png](/assets/img/ASCIS2021/clear.png)

# **ASCIS 2021**

# **CALL ME MAYBE** (100 pts)

**Problem**

*Jonathan captured something, while noob was calling his friend. Flag format: FLAG{XXX}*

Cipher.txt

1209-852 1209-852 1209-852 1209-852 1477-770 1209-852 1209-852 1209-852 1209-852 1336-941 1336-697 1477-770 1477-770 1477-697 1336-941 1477-697 1477-770 1336-852 1477-697 1477-697 1477-697

**Solve:**

- Dá»… tháº¥y Ä‘Ã¢y lÃ  **DTMF Code**, vÃ¬ tháº¿ vÃ´ [link nÃ y](https://www.dcode.fr/dtmf-code) Ä‘á»ƒ decrypt. Xong xuÃ´i ta Ä‘Æ°á»£c 1 dÃ£y sá»‘, Ä‘Ã³ chÃ­nh xÃ¡c lÃ  dÃ£y mÃ  mÃ¬nh báº¥m trÃªn con Ä‘iá»‡n thoáº¡i 9 nÃºt há»“i xÆ°a ba máº¹ mÃ¬nh hay xÃ i!!!. Hoáº·c quÄƒng vÃ´ [link nÃ y](https://www.dcode.fr/multitap-abc-cipher) náº¿u mÃ  lÆ°á»i ná»¯a ğŸ™„

> FLAG: FLAG{SMS AND DMTF}

~Dá»… nhá»~

# **AES ECB crypto challenge** (200 pts)

**Problem**

*I have an oracle to help you solve this. Give me a string (in hexa), I will give you ciphertext of your string concat with our plaintext flag*

http://125.235.240.166:20104/

**Solve**

Nháº­n xÃ©t:
- Báº¥m vÃ´ link trÃªn, ta Ä‘Æ°á»£c cÃ¡i nÃ y: ![image.png](/assets/img/ASCIS2021/problem.png)
- Sau Ä‘Ã³ mÃ¬nh thá»­ nháº­p sá»‘ "00" thÃ¬ ra Ä‘Æ°á»£c cÃ¡i nÃ y: ![image.png](/assets/img/ASCIS2021/back.png)
- Ã” kÃª ngon tháº¿ lÃ  mÃ¬nh thá»­ nháº­p 1 block 16 kÃ­ tá»± 'a' rá»“i chuyá»ƒn sang hex xem sao? VÃ  káº¿t quáº£ tráº£ vá» nhÆ° nÃ y: ![image.png](/assets/img/ASCIS2021/back2.png)
- Báº¥t ngá» khÃ´ng? He he block size = 16, Ã  Ä‘oáº¡n string tráº£ vá» cho mÃ¬nh Ä‘Ãºng nhÆ° mÃ´ táº£ Ä‘Ã£ nÃ³i: sáº½ encode hex input, sau Ä‘Ã³ ghÃ©p láº¡i vá»›i plaintext, encrypt qua AES mode ECB rá»“i tráº£ vá» cho mÃ¬nh káº¿t quáº£ nhÆ° mÃ n hÃ¬nh. 
- Vá» cÆ¡ báº£n mÃ¬nh Ä‘i qua khÃ¡i niá»‡m xÃ­u nha: **AES_ECB** lÃ  mode decrypt theo tá»«ng block, nhÆ° á»Ÿ Ä‘Ã¢y block size = 16. VÃ¬ tháº¿ nÃ³ sáº½ cáº¯t tá»«ng 16 chá»¯ cÃ¡i Ä‘á»ƒ Ä‘Æ°a vÃ o 1 lÃ´ tÃ­nh toÃ¡n phá»©c táº¡p cá»§a AES, sau Ä‘Ã³ tráº£ vá» tá»«ng ciphertext cá»§a tá»«ng block, block cuá»‘i cÃ¹ng náº¿u khÃ´ng Ä‘á»§ 16 kÃ­ tá»± sáº½ tiáº¿n hÃ nh *padding*
- Váº­y nghÄ©a lÃ : náº¿u mÃ¬nh Ä‘Æ°a vÃ o 15 kÃ­ tá»± 'a', server sáº½ encrypt block Ä‘áº§u tiÃªn lÃ  15 kÃ­ tá»± 'a' cá»§a mÃ¬nh + chá»¯ cÃ¡i Ä‘áº§u cá»§a **FLAG**!!! NhÆ°ng mÃ¬nh lÃ m gÃ¬ biáº¿t Ä‘Ãºng hay sai? Thay vÃ o Ä‘Ã³, mÃ¬nh Ä‘Æ°a 15 kÃ­ tá»± 'a' + <1 chá»¯ cÃ¡i táº¡m gá»i lÃ  input> + 15 chá»¯ cÃ¡i 'a'. NghÄ©a lÃ  náº¿u block Ä‘áº§u cá»§a mÃ¬nh (gá»“m 15 kÃ­ tá»± 'a' + input) == block thá»© 2 (gá»“m 15 kÃ­ tá»± 'a' + kÃ­ tá»± Ä‘áº§u cá»§a **FLAG**) thÃ¬ input mÃ¬nh nháº­p vÃ o lÃ  Ä‘Ãºng! Tá»›i Ä‘Ã¢y thÃ¬ bruteforce thÃ´i ğŸ˜ğŸ˜ğŸ˜
- Gá»i ans = "", cá»© má»—i kÃ­ tá»± Ä‘Ãºng mÃ¬nh sáº½ lÆ°u vÃ´ Ä‘Ã¢y Ä‘á»ƒ lÃºc tÃ¬m kÃ­ tá»± tiáº¿p theo, mÃ¬nh sáº½ dÃ¹ng *ans + input* Ä‘á»ƒ tiáº¿p tá»¥c brute force. Chi tiáº¿t máº¥y anh em xem á»Ÿ code sau nha ğŸ¦¾.

*solve.py*
```
import requests

BASE_URL = 'http://125.235.240.166:20104/'

flag = ""
print(len(flag))

for i in range(0, 64):
    for ichar in range(33,127):
        # get 
        r = requests.get(BASE_URL)

        # post
        char = chr(ichar)
        a = "a"*(64-i - 1) + flag + char + "a"*(64-i - 1)
        enc = a.encode().hex()
        data = {'input': enc}

        r = requests.post(BASE_URL + 'encrypt', data=data)
        getback = r.text
        if (getback[:128] == getback[128:256]):
            flag+=char
            print(flag)
            break

```

- Ã€ quÃªn máº¥t 1 cÃ¡i nháº­n xÃ©t lÃ  cÃ¡i FLAG nÃ y nÃ³ dÃ i hÆ¡n 32 kÃ­ tá»± =)) Chá»©ng minh Ä‘Æ¡n giáº£n láº¯m, cÃ¡i nÃ y cho cÃ¡c anh em tá»± chá»©ng minh nha nÃªn mÃ¬nh Ä‘á»ƒ predict_flag cÃ³ Ä‘á»™ dÃ i 64 cho thá»«a xÃ­u (thá»«a cÃ²n hÆ¡n thiáº¿u mÃ  ğŸ¤¡). Run chá» hÆ¡i lÃ¢u xÃ­u

>FLAG: ASCIS{AES_ECB_is_the_best_crypto!!!}

# **Simple For** (100 pts)

*Find the flag*

![image.png](/assets/img/ASCIS2021/problem2.png)

**LÆ°u Ã½: Ä‘Ã¢y khÃ´ng pháº£i crypto, Ä‘Ã¢y khÃ´ng pháº£i crypto**

**Solve:**
- Do bÃ i nÃ y láº¯m ngÆ°á»i giáº£i quÃ¡ nÃªn mÃ¬nh Ä‘Ã¢m vÃ´ Ä‘áº¥m nÃ³. ÄÃ¢y lÃ  file wireshark bÃ¬nh thÆ°á»ng thÃ´i, mÃ¬nh down vá» má»Ÿ thá»­ xem sao?


![image.png](/assets/img/ASCIS2021/ws1.png)

hmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm ğŸ˜‘ğŸ˜‘ğŸ˜ğŸ˜‘ğŸ˜‘
- ThÃ´i export object ra thá»­ xem Ä‘Æ°á»£c gÃ¬? 

![image.png](/assets/img/ASCIS2021/o1.png)
![image.png](/assets/img/ASCIS2021/f1.png)
![image.png](/assets/img/ASCIS2021/f2.png)
![image.png](/assets/img/ASCIS2021/f3.png)

- ğŸ˜ƒ
- File flag kÃ¬a anh em, báº¥m vÃ´:
![image.png](/assets/img/ASCIS2021/flag.png)

oke ngu nhÆ° tao cÃ²n lÃ m ra há»i sao 99% cÃ¡c Ä‘á»™i giáº£i Ä‘Æ°á»£c ğŸ¤¡

>FLAG: ASCIS{n3tw0rk_f0r3ns1c_1s_n0t_h4rd}






